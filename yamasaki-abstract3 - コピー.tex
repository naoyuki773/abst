%% 内容梗概

%% git test
%% プリアンブル %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[a4j]{jarticle}

\usepackage{kut-abstract}
%\usepackage[dvips]{graphicx}
\usepackage[dvipdfmx]{graphicx}
\usepackage{utf}
%% 表題 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 注意! 情報学群生の場合は，以下の \ScInfo を有効にすること．
%\ScInfo %% 情報学群生の場合

\Bachelor	%% 卒業研究論文梗概の場合
%\Project	%% プロジェクト研究報告書梗概の場合
%\Seminar	%% 特別研究セミナー課題研究報告書梗概の場合
%\Master	%% 修士学位論文（情報システム工学コース）梗概の場合
%\Doctorate	%% 博士学位論文（情報システム工学コース）梗概の場合
%\English	%% 英語の場合

\Eyears{2017}
\Etitle{English Title}
%\idnumber{}
\Eauthor{YAMASAKI， Naoyuki}
\Eaffiliate{Iwata Lab．}

%% 本文 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\years{平成29}
\title{LSTM-RNN用アクセラレータ回路の負荷割当法の検討}
\idnumber{1180386}
\author{山 \UTF{FA11} ~~尚 之}
\affiliate{コンピュータ構成学研究室}

%% 本文 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\begin{Abstract}

 \section{はじめに}てｗｓつぇつぇつぇｔ
言語処理，音声認識の分野で長期短期記憶LSTM(Long Short-term Memory)が注目されており，
組込みシステムでリアルタイム翻訳などに用いる場合アクセラレータ回路を使用し，
高速に処理する必要がある．
LSTM-RNN(Recurrent Neural Network)は
一般的な人工ニューラルネットワークANN(Artificial Neural Network)に比べ，
3種のゲートと自状態の重みが必要で演算量が大きくなる．
そのため，LSTM-RNN用アクセラレータの要求が求められるようになっている．

先行研究として，LSTMを含む微分可能ニューラルコンピュータDNC(Differentiable Neural Computer)
用単一コアの提案がされている\cite{bib:pre-method}．
しかし，シングルコアでは処理性能に限界があるためマルチコア化が求められる．

本研究では，LSTMをマルチコアで動作させる場合の負荷割り当てについて最適な方法の検討を行う．



 \section{コアの構成と負荷割り当て方法}
単一コアの機能はに示すようにIFからLUTまでの5段構成をとる．
IFステージで実行する命令を取得し，IDステージでオペランドの先頭アドレスを取得する．
次にIDステージで取得したアドレスを参照し，OFステージで演算に必要なオペランドを取得する．
そして，ALUステージで演算を行う．
必要に応じてLUTを介し演算結果をデータメモリにライトバックする．
この一連の流れを繰り返すことでLSTMを行うことが可能である．
このような機能を備えたコアをマルチコアで，並列処理させるための各コアの負荷割り当てについて検討を行う．


 負荷割り当ての方法は図\ref{フロー図}に示す3方向の軸に沿った方法が考えられる．
 \begin{figure}[h]
  \centering
  \includegraphics[scale=0.25]{flow.eps}
  \caption{LSTMの計算フロー図}
  \label{フロー図}
 \end{figure}


同時実行並列方向とパイプライン並列方向の負荷割り当ては，
図\ref{フロー図}の演算命令を左右と上下にそれぞれ分け，
各コアに割り振られた命令を実行する方法である．
データ並列方向の負荷割り当ては全命令を各コアで実行するが，
各演算に必要な行列やベクトルの要素を半分に分ける方法である．
データ並列方向の負荷割当ではデータの重複を限りなく少なくできるが，
演算に必要なデータを半分にして演算を行うため，
図\ref{フロー図}にはない足し合わせの処理が必要となる．


 \section{性能の見積もり}
 3つの負荷割り当て方法をコア数50，中間層のニューロン数200，入力数を50として，
 実行時間と回路面積を算出し比較を行った．
 結果として，データ並列方向に負荷割り当てを行った場合，
 二番目に性能の良い同時実行並列方向の割り当てに比べ，
 18\%低負荷での実行が可能であるという見積もり結果が得られた．

次に，最も性能の高い結果が得られた，
データ並列方向の負荷割り当てについて稼働率を式\ref{ラベル}により求める．
\begin{equation}
  稼働率 = \frac{実行命令数}{実行命令数+NOP命令実行数}
  \label{ラベル}
\end{equation}
%マルチコアで動作させる場合，通信回路が他のコアとの通信に使われていて，通信が行えない時などに，
%処理を行わないNOP命令が実行される．
%このNOP命令が行われているとき，演算処理は進まないためそのコアは止まった状態となり稼働率が低下する．
LSTMを実行した場合，
1タイムステップで1コアあたり実行されるNOP命令は〇〇回であり，稼働率は△△\%であった．

 \section{まとめ}
負荷の割り当て方法として，
データ並列方向の負荷割り当てが3つの割り当て方法の中で，
実行時間，回路面積の観点から最も性能が高くなるという見積もり結果が得られた．
今後，この見積もりをもとに実装を行い，実際の性能評価を行う．


%% 参考文献 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{thebibliography}{99}
 \bibitem{bib:pre-method} Akane Saito， Yuki Umezaki， and Makoto Iwata，
  ``Hardware Accelerator for Differentiable Neural Computer and Its FPGA Implementation，
  ''PDPTA'17， pp．232-238， July 2017．
\end{thebibliography}

\end{Abstract}
\end{document}
